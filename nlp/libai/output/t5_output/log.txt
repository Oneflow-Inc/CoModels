[10/17 11:53:56] libai INFO: Rank of current process: 0. World size: 1
[10/17 11:53:56] libai INFO: Command line arguments: Namespace(config_file='configs/t5_large_pretrain.py', eval_only=False, fast_dev_run=False, opts=[], resume=False)
[10/17 11:53:56] libai INFO: Contents of args.config_file=configs/t5_large_pretrain.py:
[38;5;204mfrom[39m[38;5;15m [39m[38;5;15mlibai[39m[38;5;15m.[39m[38;5;15mconfig[39m[38;5;15m [39m[38;5;204mimport[39m[38;5;15m [39m[38;5;15mLazyCall[39m
[38;5;204mfrom[39m[38;5;15m [39m[38;5;15mlibai[39m[38;5;15m.[39m[38;5;15mevaluation[39m[38;5;15m [39m[38;5;204mimport[39m[38;5;15m [39m[38;5;15mPPLEvaluator[39m
[38;5;204mfrom[39m[38;5;15m [39m[38;5;15m.[39m[38;5;15mcommon[39m[38;5;15m.[39m[38;5;15mmodels[39m[38;5;15m.[39m[38;5;15mt5[39m[38;5;15m [39m[38;5;204mimport[39m[38;5;15m [39m[38;5;15mpretrain_model[39m[38;5;15m [39m[38;5;81mas[39m[38;5;15m [39m[38;5;15mmodel[39m
[38;5;204mfrom[39m[38;5;15m [39m[38;5;15m.[39m[38;5;15mcommon[39m[38;5;15m.[39m[38;5;15mtrain[39m[38;5;15m [39m[38;5;204mimport[39m[38;5;15m [39m[38;5;15mtrain[39m
[38;5;204mfrom[39m[38;5;15m [39m[38;5;15m.[39m[38;5;15mcommon[39m[38;5;15m.[39m[38;5;15moptim[39m[38;5;15m [39m[38;5;204mimport[39m[38;5;15m [39m[38;5;15moptim[39m
[38;5;204mfrom[39m[38;5;15m [39m[38;5;15m.[39m[38;5;15mcommon[39m[38;5;15m.[39m[38;5;15mdata[39m[38;5;15m.[39m[38;5;15mt5_dataset[39m[38;5;15m [39m[38;5;204mimport[39m[38;5;15m [39m[38;5;15mdataloader[39m[38;5;15m,[39m[38;5;15m [39m[38;5;15mtokenization[39m

[38;5;204mfrom[39m[38;5;15m [39m[38;5;15m.[39m[38;5;15mcommon[39m[38;5;15m.[39m[38;5;15mmodels[39m[38;5;15m.[39m[38;5;15mgraph[39m[38;5;15m [39m[38;5;204mimport[39m[38;5;15m [39m[38;5;15mgraph[39m

[38;5;15mvocab_file[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186m/daa/dataset/bert_data/bert-base-chinese-vocab.txt[39m[38;5;186m"[39m
[38;5;15mdata_prefix[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186m/data/dataset/bert_data/loss_compara_content_sentence[39m[38;5;186m"[39m

[38;5;15mtokenization[39m[38;5;204m.[39m[38;5;15mtokenizer[39m[38;5;204m.[39m[38;5;15mvocab_file[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;15mvocab_file[39m
[38;5;15mdataloader[39m[38;5;204m.[39m[38;5;15mtrain[39m[38;5;204m.[39m[38;5;15mdataset[39m[38;5;15m[[39m[38;5;141m0[39m[38;5;15m][39m[38;5;204m.[39m[38;5;15mdata_prefix[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;15mdata_prefix[39m
[38;5;15mdataloader[39m[38;5;204m.[39m[38;5;15mtrain[39m[38;5;204m.[39m[38;5;15mdataset[39m[38;5;15m[[39m[38;5;141m0[39m[38;5;15m][39m[38;5;204m.[39m[38;5;15mindexed_dataset[39m[38;5;204m.[39m[38;5;15mdata_prefix[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;15mdata_prefix[39m
[38;5;15mdataloader[39m[38;5;204m.[39m[38;5;15mtest[39m[38;5;15m[[39m[38;5;141m0[39m[38;5;15m][39m[38;5;204m.[39m[38;5;15mdataset[39m[38;5;204m.[39m[38;5;15mdata_prefix[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;15mdata_prefix[39m
[38;5;15mdataloader[39m[38;5;204m.[39m[38;5;15mtest[39m[38;5;15m[[39m[38;5;141m0[39m[38;5;15m][39m[38;5;204m.[39m[38;5;15mdataset[39m[38;5;204m.[39m[38;5;15mindexed_dataset[39m[38;5;204m.[39m[38;5;15mdata_prefix[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;15mdata_prefix[39m

[38;5;245m# T5-large model config[39m
[38;5;15mmodel[39m[38;5;204m.[39m[38;5;15mcfg[39m[38;5;204m.[39m[38;5;15mnum_attention_heads[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;141m12[39m
[38;5;15mmodel[39m[38;5;204m.[39m[38;5;15mcfg[39m[38;5;204m.[39m[38;5;15mhidden_size[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;141m384[39m
[38;5;15mmodel[39m[38;5;204m.[39m[38;5;15mcfg[39m[38;5;204m.[39m[38;5;15mhidden_layers[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;141m6[39m

[38;5;15mtrain[39m[38;5;204m.[39m[38;5;15minput_placement_device[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mcpu[39m[38;5;186m"[39m

[38;5;15mtrain[39m[38;5;204m.[39m[38;5;15mdist[39m[38;5;204m.[39m[38;5;15mpipeline_num_layers[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;141m2[39m[38;5;15m [39m[38;5;204m*[39m[38;5;15m [39m[38;5;15mmodel[39m[38;5;204m.[39m[38;5;15mcfg[39m[38;5;204m.[39m[38;5;15mhidden_layers[39m

[38;5;15mtrain[39m[38;5;204m.[39m[38;5;15mtrain_micro_batch_size[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;141m16[39m
[38;5;15mtrain[39m[38;5;204m.[39m[38;5;15mamp[39m[38;5;204m.[39m[38;5;15menabled[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;81mTrue[39m

[38;5;15mtrain[39m[38;5;204m.[39m[38;5;15mevaluation[39m[38;5;204m.[39m[38;5;15mevaluator[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;15mLazyCall[39m[38;5;15m([39m[38;5;15mPPLEvaluator[39m[38;5;15m)[39m[38;5;15m([39m[38;5;15m)[39m

[38;5;15mtrain[39m[38;5;204m.[39m[38;5;15moutput_dir[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186m./output/t5_output[39m[38;5;186m"[39m

[10/17 11:53:56] libai INFO: Full config saved to ./output/t5_output/config.yaml
[10/17 11:53:56] lb.engine.default INFO: > compiling dataset index builder ...
[10/17 11:53:56] lb.engine.default INFO: >>> done with dataset index builder. Compilation time: 0.078 seconds
[10/17 11:53:56] lb.engine.default INFO: >>> done with compiling. Compilation time: 0.079 seconds
